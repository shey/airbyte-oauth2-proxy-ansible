# {{ ansible_managed }}

server {
  server_name shey.ca;

  root /home/deploy/www/shey.ca;
  access_log /var/log/nginx/shey.ca.access.log;
  error_log /var/log/nginx/shey.ca.error.log notice;

  location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {
    #expires 1d;
    add_header Cache-Control no-cache;

    add_header ETag "";
    break;
  }

    listen 443 ssl http2; # managed by Certbot
    ssl_certificate /etc/letsencrypt/live/shey.ca-0001/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/shey.ca-0001/privkey.pem; # managed by Certbot
    include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot
}

server {
  # managed by Certbot
  if ($host = shey.ca) {
      return 301 https://$host$request_uri;
  }

  listen 80;
  server_name shey.ca;
  return 404; # managed by Certbot
}
